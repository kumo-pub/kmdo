---
slug: /cmd/pkg
---

# kmdo pkg 命令文档

## 用法（Usage）
kmdo 工具的二进制文件打包、解包及配置模板生成子命令集。通过 `pkg` 子命令实现二进制文件与部署配置的高效管理，支持模板创建、打包、解包操作。

### 用法

```bash
kmdo pkg [子命令] [参数]
```
- template: 生成默认的包配置模板文件（JSON 格式）
- pack: 将二进制文件与部署文件打包为 tar 归档包
- unpack: 从 tar 归档包中提取内容到目标目录

## template 子命令

生成默认的包配置模板文件（JSON 格式），用于后续二进制文件打包与部署配置管理。
若目标路径已存在文件，会自动按 name-i.ext 格式重命名（例如 package.template-1.json），避免覆盖现有文件。

### 用法

```shell
kmdo pkg template [--output|-o <文件路径>]
```

### 参数说明

| 参数名       | 简写 | 默认值                | 描述                          |
|--------------|------|-----------------------|-------------------------------|
| `--output`   | `-o` | `package.template.json` | 生成模板文件的保存路径        |

```shell
# 生成模板文件，使用默认路径（package.template.json）
kmdo pkg template

# 生成模板文件，指定自定义输出路径
kmdo pkg template -o my-package-template.json

# 若目标文件已存在，自动重命名（如 existing.json → existing-1.json）
kmdo pkg template -o existing.json
```

## pack 子命令

从指定输入目录读取二进制文件，结合配置文件中的部署配置，将所有
内容打包为压缩的 tar 归档包，归档包保存至指定输出目录。支持干跑模式，仅
验证配置与依赖文件，不执行实际打包操作。

```shell
kmdo pkg pack [--config|-c <配置文件路径>] [--input|-i <输入目录>] [--output|-o <输出目录>] [--dry-run|-d]
```

### 参数说明
| 参数名       | 简写 | 默认值         | 描述                                  |
|--------------|------|----------------|---------------------------------------|
| `--config`   | `-c` | `package.json` | 包配置文件路径（指定打包规则与依赖）  |
| `--input`    | `-i` | `.`            | 待打包二进制文件所在目录（默认当前目录）|
| `--output`   | `-o` | `dist`         | 生成 tar 归档包的保存目录            |
| `--dry-run`  | `-d` | `false`        | 干跑模式，仅验证配置与文件，不打包    |

```shell
# 使用默认配置、输入目录和输出目录执行打包
kmdo pkg pack

# 指定自定义配置文件和输入目录
kmdo pkg pack -c my-config.json -i ./bin

# 执行干跑模式，验证配置是否合法
kmdo pkg pack --dry-run
```



## unpack 子命令
从指定输入目录读取 tar 归档包，将其中的二进制文件与部署配置提取到目标输出
目录。可通过清单文件验证归档包完整性（禁用信任模式时），信任模式下将跳过完整
性校验，直接执行提取操作。

### 用法

```shell
kmdo pkg unpack [--manifest|-m <清单文件路径>] [--input|-i <输入目录>] [--output|-o <输出目录>] [--trust|-t]
```

### 参数说明

| 参数名       | 简写 | 默认值         | 描述                                  |
|--------------|------|----------------|---------------------------------------|
| `--manifest` | `-m` | `manifest.json` | 用于完整性校验的清单文件路径          |
| `--input`    | `-i` | `.`            | 待解包 tar 归档包所在目录（默认当前目录）|
| `--output`   | `-o` | `dist`         | 归档包内容的提取目录                  |
| `--trust`    | `-t` | `false`        | 信任模式，跳过归档包完整性校验        |

```shell
# 使用默认清单文件、输入目录和输出目录执行解包
kmdo pkg unpack

# 指定自定义清单文件和输出目录
kmdo pkg unpack -m my-manifest.json -o ./extract-dir

# 启用信任模式，跳过完整性校验直接解包
kmdo pkg unpack --trust
```


    