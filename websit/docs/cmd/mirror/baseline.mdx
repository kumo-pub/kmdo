---
slug: /cmd/mirror/baseline
---
# kmdo mirror baseline 命令文档
## 概述
kmdo mirror baseline 命令用于管理本地镜像的基准配置，支持查看基准全局信息与组件基准映射、更新基准版本（含语义化版本递增）、配置单个组件的基准版本，核心是实现本地镜像与上游最新状态的对齐，确保组件基准版本的标准化管理。

## 命令结构
```shell
kmdo mirror baseline [COMMAND] [--options]
```

## 基础命令列表
| 命令 | 描述 |
|------|------|
| kmdo mirror baseline | 查看基准全局配置（基准版本、修改时间、组件基准映射） |
| kmdo mirror baseline update | 更新基准版本（全局语义化版本递增）或配置单个组件基准 |
| kmdo mirror baseline show | 查看基准详细信息（当前功能待完善，仅输出提示） |

## 命令 Flags 总览
| 命令 | Flag | 简写 | 类型 | 默认值 | 是否必填 | 描述 |
|------|------|------|------|--------|----------|------|
| update | --version-type | -t | 字符串 | "patch" | 否 | 基准版本递增类型（major/主版本、minor/次版本、patch/补丁版本） |
| update | --component | -c | 字符串 | "" | 是（组件操作时） | 目标组件名称（添加/更新/删除组件基准时必填） |
| update | --baseline-version | -v | 字符串 | "" | 是（组件操作时） | 组件的基准版本（添加/更新组件基准时必填） |
| update | --author | -a | 字符串 | "stable" | 否 | 组件发布者（注：代码注释标注为渠道，实际为发布者字段，需以最终逻辑为准） |
| update | --enmail | -e | 字符串 | "stable" | 否 | 发布者邮箱（字段名疑似笔误，实际为邮箱配置，需以最终逻辑为准） |

## 详细子命令说明
### 1. kmdo mirror baseline（默认查看命令）
#### 功能
查看本地镜像的基准全局配置和组件基准映射，包括基准版本、最后修改时间、组件总数及各组件的基准版本与渠道。
#### 用法
无需额外参数，直接执行：
```shell
kmdo mirror baseline
#### 输出示例
=== Baseline Configuration ===
Baseline Version     : 1.2.3
Last Modified        : 2024-06-20T16:45:30+08:00
Component Count      : 2

=== Component Baseline Mappings ===
Component Name       Baseline Version Channel
--------------------------------------------------------
component-a          v1.2.0          stable
component-b          v2.0.1          beta

#### 无组件基准时输出
=== Baseline Configuration ===
Baseline Version     : 1.0.0
Last Modified        : 2024-06-20T16:45:30+08:00
Component Count      : 0

No components configured in baseline
```
### 2. kmdo mirror baseline update
#### 功能
两种核心用法：一是全局基准版本递增（按指定类型更新基准版本号）；二是添加/更新单个组件的基准版本（指定组件名称、基准版本等信息）。
#### 用法
# 全局基准版本递增（无需组件参数，按--version-type更新）
```shell
kmdo mirror baseline update --version-type <类型>

# 添加/更新单个组件基准（需指定组件相关参数）
kmdo mirror baseline update \
  --component <组件名称> \
  --baseline-version <基准版本> \
  [--author <发布者>] \
  [--enmail <发布者邮箱>] \
  [--version-type <类型>]
#### 示例
# 全局基准版本补丁号递增（1.2.3 → 1.2.4）
kmdo mirror baseline update -t patch

# 全局基准版本次版本递增（1.2.4 → 1.3.0）
kmdo mirror baseline update -t minor

# 添加组件 component-c 的基准版本 v3.1.0
kmdo mirror baseline update \
  -c component-c \
  -v v3.1.0 \
  -a "kmdo team" \
  -e "team@kmdo.com"

# 更新组件 component-a 的基准版本为 v1.3.0，主版本递增全局基准
kmdo mirror baseline update \
  -c component-a \
  -v v1.3.0 \
  -t major
```

#### 执行逻辑
1. 版本类型转换：--version-type 会自动转为小写，映射为对应的版本递增类型（major/minor/patch），默认值为 patch。
2. 全局版本递增：未指定 --component 时，仅按 --version-type 更新基准全局版本号，不修改组件基准映射。
3. 组件基准配置：指定 --component 和 --baseline-version 时，添加或更新该组件的基准版本、渠道等信息，同时可同步递增全局基准版本。

### 3. kmdo mirror baseline show
#### 功能
查看基准详细信息（当前代码仅输出提示信息，功能待完善）。
#### 用法

```shell
kmdo mirror baseline show
```

#### 输出示例
baseline cmd

## 核心字段说明
### 1. 基准全局信息
| 字段 | 含义 |
|------|------|
| Baseline Version | 基准全局版本号（遵循语义化版本规范 X.Y.Z） |
| Last Modified | 基准最后修改时间（RFC3339格式） |
| Component Count | 已配置基准的组件总数 |

### 2. 组件基准映射
| 字段 | 含义 |
|------|------|
| Component Name | 组件名称（唯一标识） |
| Baseline Version | 该组件的基准版本号 |
| Channel | 组件发布渠道（stable/nightly/beta等） |

## 注意事项
1. 字段修正：--author 代码注释标注为“组件发布渠道”，实际功能为配置发布者；--enmail 疑似字段名笔误（应为 --email），实际用于配置发布者邮箱，使用时需以最终功能逻辑为准。
2. 必填参数：执行组件基准添加/更新时，--component 和 --baseline-version 为必填参数，缺失会导致执行失败。
3. 版本类型限制：--version-type 仅支持 major/minor/patch 三个值，输入其他值会默认按 patch 处理。
4. 组件排序：组件基准映射输出时按组件名称字母序排序，便于查找。
5. 功能完善：show 子命令当前仅输出提示，详细功能需等待后续版本补充。

## 待补充说明（后续版本完善）
- show 子命令的详细功能（如按组件筛选查看基准、基准变更历史等）。
- 组件基准的删除操作（当前仅支持添加/更新，删除功能待补充）。
- --author 和 --enmail 字段的最终功能确认及注释修正。
- 基准版本冲突处理规则（如组件基准版本不存在时的报错逻辑）。

要不要我帮你整理一份 **纯文本格式的kmdo-mirror-baseline命令操作手册**，包含完整场景用法、参数校验规则和常见问题排查，方便嵌入到项目文档中？