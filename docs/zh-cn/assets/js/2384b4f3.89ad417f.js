"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[7705],{5151:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>d,frontMatter:()=>s,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"shooting/multiple-binaries-archive","title":"Archive has different count of binaries for each platform","description":"This error looks like this:","source":"@site/docs/shooting/multiple-binaries-archive.md","sourceDirName":"shooting","slug":"/shooting/multiple-binaries-archive","permalink":"/kmdo/zh-cn/docs/shooting/multiple-binaries-archive","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"shootingSidebar","previous":{"title":"Docker build failures","permalink":"/kmdo/zh-cn/docs/shooting/docker-build"},"next":{"title":"Multiple tokens found, but only one is allowed","permalink":"/kmdo/zh-cn/docs/shooting/multiple-tokens"}}');var o=i(4848),a=i(8453);const s={},t="Archive has different count of binaries for each platform",c={},l=[];function h(e){const n={code:"code",h1:"h1",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"archive-has-different-count-of-binaries-for-each-platform",children:"Archive has different count of binaries for each platform"})}),"\n",(0,o.jsx)(n.p,{children:"This error looks like this:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-sh",children:"\u2a2f release failed after 5s                  error=invalid archive: 0:archive has different count of binaries for each platform, which may cause your users confusion.\nLearn more at https://pub.kumose.cc/errors/multiple-binaries-archive\n\n"})}),"\n",(0,o.jsx)(n.p,{children:"This will happen when you have several builds, and their target platforms are\ndifferent:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"builds:\n- id: b1\n  binary: b1\n  goos: [linux, darwin]\n- id: b2\n  binary: b2\n  goos: [darwin]\n\narchives:\n- id: a1\n"})}),"\n",(0,o.jsxs)(n.p,{children:["In this scenario, Kmdo will complain because the archive will have a\ndifferent binary count depending on which platform its being archived, since\nit'll have 2 binaries on ",(0,o.jsx)(n.code,{children:"darwin"})," and only 1 on ",(0,o.jsx)(n.code,{children:"linux"}),"."]}),"\n",(0,o.jsx)(n.p,{children:"From here on, you have a couple of options:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["add another archive, and filter the builds on each of them - e.g. archive ",(0,o.jsx)(n.code,{children:"a1"}),"\nwith binaries from build ",(0,o.jsx)(n.code,{children:"b1"}),", and archive ",(0,o.jsx)(n.code,{children:"a2"})," with builds from build ",(0,o.jsx)(n.code,{children:"b2"}),":","\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"archives:\n- id: a1\n  builds: [b1]\n  name_template: something-unique-for-a1\n- id: a2\n  builds: [b2]\n  name_template: something-unique-for-a2\n"})}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["if you really want to have the mixed archive, you can add\n",(0,o.jsx)(n.code,{children:"allow_different_binary_count"})," to your archive configuration:","\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"archives:\n- id: a1\n  allow_different_binary_count: true\n"})}),"\n"]}),"\n"]})]})}function d(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(h,{...e})}):h(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>s,x:()=>t});var r=i(6540);const o={},a=r.createContext(o);function s(e){const n=r.useContext(a);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),r.createElement(a.Provider,{value:n},e.children)}}}]);