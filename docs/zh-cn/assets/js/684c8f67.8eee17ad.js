"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[2741],{5402:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>d,default:()=>c,frontMatter:()=>o,metadata:()=>t,toc:()=>u});const t=JSON.parse('{"id":"tutorial/pub/builds/uv","title":"UV","description":"You can now build Python wheel and sdist files using uv build and","source":"@site/docs/tutorial/pub/builds/uv.mdx","sourceDirName":"tutorial/pub/builds","slug":"/tutorial/pub/builds/uv","permalink":"/kmdo/zh-cn/docs/tutorial/pub/builds/uv","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"UPX","permalink":"/kmdo/zh-cn/docs/tutorial/pub/builds/upx"},"next":{"title":"Verifiable Builds","permalink":"/kmdo/zh-cn/docs/tutorial/pub/builds/verifiable_builds"}}');var s=i(4848),l=i(8453);const o={},d="UV",a={},u=[{value:"Options",id:"options",level:2},{value:"Building both wheel and sdist",id:"building-both-wheel-and-sdist",level:2},{value:"Publishing to PyPi",id:"publishing-to-pypi",level:2}];function r(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,l.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"uv",children:"UV"})}),"\n",(0,s.jsxs)(n.p,{children:["You can now build Python ",(0,s.jsx)(n.code,{children:"wheel"})," and ",(0,s.jsx)(n.code,{children:"sdist"})," files using ",(0,s.jsx)(n.code,{children:"uv build"})," and\nKmdo!"]}),"\n",(0,s.jsxs)(n.p,{children:["Simply set the ",(0,s.jsx)(n.code,{children:"builder"})," to ",(0,s.jsx)(n.code,{children:"uv"})," and set the ",(0,s.jsx)(n.code,{children:"buildmode"})," you want:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'title=".kmdopkg.yaml"',children:"builds:\n  - builder: uv\n    buildmode: wheel\n"})}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:".whl"})," and ",(0,s.jsx)(n.code,{children:".tar.gz"})," files can then be signed, checksummed, used inside\nDocker images, and more."]}),"\n",(0,s.jsx)(n.h2,{id:"options",children:"Options"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'title=".kmdopkg.yaml"',children:'builds:\n  # You can have multiple builds defined as a yaml list\n  - #\n    # ID of the build.\n    #\n    # Default: Project directory name.\n    id: "my-build"\n\n    # Use uv.\n    builder: uv\n\n    # Path to project\'s (sub)directory containing the code.\n    # This is the working directory for the uv build command(s).\n    #\n    # Default: ".".\n    dir: my-app\n\n    # The build mode.\n    #\n    # Valid options: "wheel", "sdist".\n    # Default: "wheel".\n    buildmode: sdist\n\n    # Set a specific uv binary to use when building.\n    # It is safe to ignore this option in most cases.\n    #\n    # Default: "uv".\n    # Templates: allowed.\n    tool: uv\n\n    # Sets the command to run to build.\n    # Can be useful if you want to build tests, for example,\n    # in which case you can set this to "test".\n    # It is safe to ignore this option in most cases.\n    #\n    # Default: build.\n    command: build\n\n    # Custom flags.\n    #\n    # Templates: allowed.\n    flags:\n      - --offline\n\n    # Custom environment variables to be set during the builds.\n    # Invalid environment variables will be ignored.\n    #\n    # Default: os.Environ() ++ env config section.\n    # Templates: allowed.\n    env:\n      - FOO=bar\n\n    # Hooks can be used to customize the final binary,\n    # for example, to run generators.\n    #\n    # Templates: allowed.\n    hooks:\n      pre: ./foo.sh\n      post: ./script.sh {{ .Path }}\n'})}),"\n",(0,s.jsx)(n.admonition,{type:"warning",children:(0,s.jsxs)(n.p,{children:["At this time only the target ",(0,s.jsx)(n.code,{children:"py3-none-any"})," is supported."]})}),"\n",(0,s.jsx)(n.h2,{id:"building-both-wheel-and-sdist",children:"Building both wheel and sdist"}),"\n",(0,s.jsx)(n.p,{children:"You need to declare 2 builds, one for each mode:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'title=".kmdopkg.yaml"',children:"builds:\n  - id: wheel\n    builder: uv\n    buildmode: wheel\n  - id: sdist\n    builder: uv\n    buildmode: sdist\n"})}),"\n",(0,s.jsx)(n.h2,{id:"publishing-to-pypi",children:"Publishing to PyPi"}),"\n",(0,s.jsxs)(n.p,{children:["You can use ",(0,s.jsx)(n.a,{href:"/kmdo/zh-cn/docs/tutorial/pub/general/hooks",children:"global after hooks"})," to do it:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'title=".kmdopkg.yaml"',children:'# global after hooks\nafter:\n  - cmd: "uv publish"\n    if: "{{ .IsRelease }}"\n'})})]})}function c(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(r,{...e})}):r(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>d});var t=i(6540);const s={},l=t.createContext(s);function o(e){const n=t.useContext(l);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(l.Provider,{value:n},e.children)}}}]);