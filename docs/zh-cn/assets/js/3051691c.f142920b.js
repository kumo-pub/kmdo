"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[5043],{8453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>i});var a=t(6540);const o={},s=a.createContext(o);function r(e){const n=a.useContext(s);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),a.createElement(s.Provider,{value:n},e.children)}},8460:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>p,frontMatter:()=>r,metadata:()=>a,toc:()=>l});const a=JSON.parse('{"id":"tutorial/pub/archive/snapcraft","title":"Snapcraft Packages (snaps)","description":"Kmdo can also generate snap packages.","source":"@site/docs/tutorial/pub/archive/snapcraft.mdx","sourceDirName":"tutorial/pub/archive","slug":"/tutorial/pub/archive/snapcraft","permalink":"/zh-cn/docs/tutorial/pub/archive/snapcraft","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Linux packages (via nFPM)","permalink":"/zh-cn/docs/tutorial/pub/archive/nfpm"},"next":{"title":"Source Archive","permalink":"/zh-cn/docs/tutorial/pub/archive/source"}}');var o=t(4848),s=t(8453);const r={},i="Snapcraft Packages (snaps)",c={},l=[];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",header:"header",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"snapcraft-packages-snaps",children:"Snapcraft Packages (snaps)"})}),"\n",(0,o.jsxs)(n.p,{children:["Kmdo can also generate ",(0,o.jsx)(n.code,{children:"snap"})," packages.\n",(0,o.jsx)(n.a,{href:"http://snapcraft.io/",children:"Snaps"})," are a new packaging format, that will let you\npublish your project directly to the Ubuntu store.\nFrom there it will be installable in all the\n",(0,o.jsx)(n.a,{href:"https://snapcraft.io/docs/core/install",children:"supported Linux distros"}),", with\nautomatic and transactional updates."]}),"\n",(0,o.jsx)(n.admonition,{type:"warning",children:(0,o.jsx)(n.p,{children:"Snapcraft packages can't be build inside a Docker container."})}),"\n",(0,o.jsxs)(n.p,{children:["You can read more about it in the ",(0,o.jsx)(n.a,{href:"https://snapcraft.io/docs/",children:"snapcraft docs"}),"."]}),"\n",(0,o.jsx)(n.p,{children:"Available options:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",metastring:'title=".kmdopkg.yaml"',children:'snapcrafts:\n  - #\n    # ID of the snapcraft config, must be unique.\n    #\n    # Default: \'default\'.\n    id: foo\n\n    # IDs of the builds which should be archived in this package.\n    #\n    # Default: empty (include all).\n    ids:\n      - foo\n      - bar\n\n    # You can change the name of the package.\n    #\n    # Default: \'{{ .ProjectName }}_{{ .Version }}_{{ .Os }}_{{ .Arch }}{{ with .Arm }}v{{ . }}{{ end }}{{ with .Mips }}_{{ . }}{{ end }}{{ if not (eq .Amd64 "v1") }}{{ .Amd64 }}{{ end }}\'.\n    # Templates: allowed.\n    name_template: "{{ .ProjectName }}_{{ .Version }}_{{ .Os }}_{{ .Arch }}"\n\n    # The name of the snap. This is optional.\n    #\n    # Default: the project name.\n    name: drumroll\n\n    # The canonical title of the application, displayed in the software\n    # centre graphical frontends.\n    title: Drum Roll\n\n    # Path to icon image that represents the snap in the snapcraft.io store\n    # pages and other graphical store fronts.\n    icon: ./icon.png\n\n    # Whether to publish the snap to the snapcraft store.\n    # Remember you need to `snapcraft login` first.\n    publish: true\n\n    # Single-line elevator pitch for your amazing snap.\n    # 79 char long at most.\n    summary: Software to create fast and easy drum rolls.\n\n    # This the description of your snap. You have a paragraph or two to tell the\n    # most important story about your snap. Keep it under 100 words though,\n    # we live in tweetspace and your description wants to look good in the snap\n    # store.\n    description: This is the best drum roll application out there. Install it and awe!\n\n    # Disable this configuration.\n    #\n    # Templates: allowed.\n    disable: true\n\n    # Channels in store where snap will be pushed.\n    #\n    # More info about channels here:\n    # https://snapcraft.io/docs/reference/channels\n    #\n    # Default:\n    #   grade is \'stable\': ["edge", "beta", "candidate", "stable"]\n    #   grade is \'devel\': ["edge", "beta"]\n    # Templates: allowed.\n    channel_templates:\n      - edge\n      - beta\n      - candidate\n      - stable\n      - "{{ .Major }}.{{ .Minor }}/edge"\n      - "{{ .Major }}.{{ .Minor }}/beta"\n      - "{{ .Major }}.{{ .Minor }}/candidate"\n      - "{{ .Major }}.{{ .Minor }}/stable"\n\n    # A guardrail to prevent you from releasing a snap to all your users before\n    # it is ready.\n    # `devel` will let you release only to the `edge` and `beta` channels in the\n    # store. `stable` will let you release also to the `candidate` and `stable`\n    # channels.\n    #\n    # Default: \'stable\'\n    grade: stable\n\n    # Snaps can be setup to follow three different confinement policies:\n    # `strict`, `devmode` and `classic`. A strict confinement where the snap\n    # can only read and write in its own namespace is recommended. Extra\n    # permissions for strict snaps can be declared as `plugs` for the app, which\n    # are explained later. More info about confinement here:\n    # https://snapcraft.io/docs/reference/confinement\n    #\n    # Default: \'strict\'\n    confinement: strict\n\n    # Your app\'s license, based on SPDX license expressions:\n    # https://spdx.org/licenses\n    license: MIT\n\n    # A snap of type base to be used as the execution environment for this snap.\n    # Valid values are:\n    # * bare - Empty base snap;\n    # * core - Ubuntu Core 16;\n    # * core18 - Ubuntu Core 18.\n    base: core18\n\n    # A list of features that must be supported by the core in order for\n    # this snap to install.\n    assumes:\n      - snapd2.38\n\n    # his top-level keyword to define a hook with a plug to access more\n    # privileges.\n    hooks:\n      install:\n        - network\n\n    # Add extra files on the resulting snap. Useful for including wrapper\n    # scripts or other useful static files. Source filenames are relative to the\n    # project directory. Destination filenames are relative to the snap prime\n    # directory.\n    extra_files:\n      - source: drumroll.wrapper\n        destination: bin/drumroll.wrapper\n        mode: 0755\n\n\n    # With layouts, you can make elements in $SNAP, $SNAP_DATA, $SNAP_COMMON\n    # accessible from locations such as /usr, /var and /etc. This helps when\n    # using pre-compiled binaries and libraries that expect to find files and\n    # directories outside of locations referenced by $SNAP or $SNAP_DATA.\n    # About snap environment variables:\n    # * HOME: set to SNAP_USER_DATA for all commands\n    # * SNAP: read-only install directory\n    # * SNAP_ARCH: the architecture of device (eg, amd64, arm64, armhf, i386, etc)\n    # * SNAP_DATA: writable area for a particular revision of the snap\n    # * SNAP_COMMON: writable area common across all revisions of the snap\n    # * SNAP_LIBRARY_PATH: additional directories which should be added to LD_LIBRARY_PATH\n    # * SNAP_NAME: snap name\n    # * SNAP_INSTANCE_NAME: snap instance name incl. instance key if one is set (snapd 2.36+)\n    # * SNAP_INSTANCE_KEY: instance key if any (snapd 2.36+)\n    # * SNAP_REVISION: store revision of the snap\n    # * SNAP_USER_DATA: per-user writable area for a particular revision of the snap\n    # * SNAP_USER_COMMON: per-user writable area common across all revisions of the snap\n    # * SNAP_VERSION: snap version (from snap.yaml)\n    # More info about layout here:\n    # https://snapcraft.io/docs/snap-layouts\n    layout:\n      # The path you want to access in sandbox.\n      /etc/drumroll:\n        # Which outside file or directory you want to map to sandbox.\n        # Valid keys are:\n        # * bind - Bind-mount a directory.\n        # * bind_file - Bind-mount a file.\n        # * symlink - Create a symbolic link.\n        # * type - Mount a private temporary in-memory filesystem.\n        bind: $SNAP_DATA/etc\n\n    # Each binary built by Kmdo is an app inside the snap. In this section\n    # you can declare extra details for those binaries. It is optional.\n    # See: https://snapcraft.io/docs/snapcraft-app-and-service-metadata\n    apps:\n      # The name of the app must be the same name as the binary built or the snapcraft name.\n      drumroll:\n        # If you any to pass args to your binary, you can add them with the\n        # args option.\n        args: --foo\n\n        # The kind of wrapper to generate for the given command.\n        adapter: none\n\n        # List of applications that are ordered to be started after the current\n        # one.\n        after: ["postdrum"]\n\n        # Aliases for the app command.\n        # https://snapcraft.io/docs/commands-and-aliases#heading--aliases\n        aliases: ["droll"]\n\n        # Defines the name of the .desktop file used to start an application\n        # with the desktop session.\n        # https://snapcraft.io/docs/snap-format#heading--autostart\n        autostart: drumroll.desktop\n\n        # List of applications that are ordered to be started before the current\n        # one.\n        before: ["predrum"]\n\n        # D-Bus name this service is reachable as. Mandatory if daemon=dbus.\n        bus_name: drumbus\n\n        # A list of commands to be executed in order before the command of this\n        # app.\n        command_chain: ["foo", "bar", "baz"]\n\n        # An identifier to a desktop-id within an external appstream file.\n        # https://snapcraft.io/docs/using-external-metadata\n        common_id: "com.example.drumroll"\n\n        # Bash completion snippet. More information about completion here:\n        # https://snapcraft.io/docs/tab-completion.\n        completer: drumroll-completion.bash\n\n        # You can override the command name.\n        #\n        # Default: AppName.\n        command: bin/drumroll.wrapper\n\n        # If you want your app to be autostarted and to always run in the\n        # background, you can make it a simple daemon.\n        daemon: simple\n\n        # Location of the .desktop file.\n        desktop: usr/share/applications/drumroll.desktop\n\n        # A set of key-value pairs specifying environment variables.\n        environment:\n          foo: bar\n          baz: quo\n\n        # A list of Snapcraft extensions this app depends on.\n        # https://snapcraft.io/docs/snapcraft-extensions\n        extensions: ["gnome-3-38"]\n\n        # Defines whether a freshly installed daemon is started automatically,\n        # or whether startup control is deferred to the snap.\n        # Requires `daemon` to be set.\n        install_mode: "disable"\n\n        # A set of key-value attributes passed through to snap.yaml without\n        # snapcraft validation.\n        # https://snapcraft.io/docs/using-in-development-features\n        passthrough:\n          foo: bar\n\n        # If your app requires extra permissions to work outside of its default\n        # confined space, declare them here.\n        # You can read the documentation about the available plugs and the\n        # things they allow:\n        # https://snapcraft.io/docs/supported-interfaces.\n        plugs: ["home", "network", "personal-files"]\n\n        # Sets a command to run from inside the snap after a service stops.\n        post_stop_command: foo\n\n        # Controls whether the daemon should be restarted during a snap refresh.\n        refresh_mode: endure\n\n        # Command to use to ask the service to reload its configuration.\n        # Requires `daemon` to be set.\n        reload_command: foo\n\n        # Restart condition of the snap.\n        # https://snapcraft.io/docs/snapcraft-yaml-reference\n        restart_condition: "always"\n\n        # List of slots for interfaces to connect to.\n        slots: ["foo", "bar", "baz"]\n\n        # Maps a daemon\u2019s sockets to services and activates them.\n        # Requires `plugs` to contain `network-bind`.\n        sockets:\n          sock:\n            listen-stream: $SNAP_COMMON/socket\n            socket-group: socket-group\n            socket-mode: 416\n\n        # Time to wait for daemon to start.\n        start_timeout: 42ms\n\n        # Command to use to stop the service.\n        # Requires `daemon` to be set.\n        stop_command: foo\n\n        # Controls how the daemon should be stopped.\n        # Requires `daemon` to be set.\n        stop_mode: sigterm\n\n        # Time to wait for daemon to stop.\n        stop_timeout: 42ms\n\n        # Schedules when, or how often, to run a service or command.\n        # Requires `daemon` to be set.\n        # https://snapcraft.io/docs/services-and-daemons\n        timer: "00:00-24:00/24"\n\n        # Declares the service watchdog timeout.\n        # Requires `plugs` to contain `daemon-notify`.\n        watchdog_timeout: 42ms\n\n    # Allows plugs to be configured. Plugs like system-files and personal-files\n    # require this.\n    plugs:\n      personal-files:\n        read:\n          - $HOME/.foo\n        write:\n          - $HOME/.foo\n          - $HOME/.foobar\n'})}),"\n",(0,o.jsx)(n.admonition,{type:"info",children:(0,o.jsxs)(n.p,{children:["Kmdo will not install ",(0,o.jsx)(n.code,{children:"snapcraft"})," nor any of its dependencies for you."]})})]})}function p(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}}}]);