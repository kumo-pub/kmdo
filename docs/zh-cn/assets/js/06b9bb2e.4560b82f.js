"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[7029],{5064:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>c,frontMatter:()=>s,metadata:()=>o,toc:()=>p});const o=JSON.parse('{"id":"tutorial/pub/publish/aursources","title":"Arch User Repositories (Sources)","description":"After releasing to GitHub, GitLab, or Gitea, Kmdo can generate and publish","source":"@site/docs/tutorial/pub/publish/aursources.mdx","sourceDirName":"tutorial/pub/publish","slug":"/tutorial/pub/publish/aursources","permalink":"/kmdo/zh-cn/docs/tutorial/pub/publish/aursources","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Arch User Repositories","permalink":"/kmdo/zh-cn/docs/tutorial/pub/publish/aur"},"next":{"title":"Blobs (s3, gcs, azblob)","permalink":"/kmdo/zh-cn/docs/tutorial/pub/publish/blob"}}');var a=t(4848),i=t(8453);const s={},r="Arch User Repositories (Sources)",l={},p=[];function u(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",header:"header",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"arch-user-repositories-sources",children:"Arch User Repositories (Sources)"})}),"\n",(0,a.jsxs)(n.p,{children:["After releasing to GitHub, GitLab, or Gitea, Kmdo can generate and publish\na ",(0,a.jsx)(n.code,{children:"PKGBUILD"})," to an ",(0,a.jsx)(n.em,{children:"Arch User Repository"})," based on sources."]}),"\n",(0,a.jsx)(n.admonition,{type:"warning",children:(0,a.jsxs)(n.p,{children:["Before going further on this, make sure to read\n",(0,a.jsx)(n.a,{href:"https://wiki.archlinux.org/title/AUR_submission_guidelines",children:"AUR's Submission Guidelines"}),"."]})}),"\n",(0,a.jsx)(n.p,{children:"This page describes the available options."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",metastring:'title=".kmdopkg.yaml"',children:'aur_sources:\n  - # The package name.\n    #\n    # Note that since this integration creates a PKGBUILD to build from\n    # source, per Arch\'s guidelines.\n    # That said, Kmdo will remove `-bin` suffix if its present.\n    #\n    # Default: ProjectName.\n    name: package\n\n    # Artifact IDs to filter for.\n    # Empty means all IDs (no filter).\n    ids:\n      - foo\n      - bar\n\n    # Your app\'s homepage.\n    #\n    # Default: inferred from global metadata.\n    homepage: "https://example.com/"\n\n    # Your app\'s description.\n    #\n    # Templates: allowed.\n    # Default: inferred from global metadata.\n    description: "Software to create fast and easy drum rolls."\n\n    # The maintainers of the package.\n    #\n    # Default: inferred from global metadata.\n    maintainers:\n      - "Foo Bar <foo at bar dot com>"\n\n    # The contributors of the package.\n    contributors:\n      - "Foo Zaz <foo at zaz dot com>"\n\n    # SPDX identifier of your app\'s license.\n    #\n    # Default: inferred from global metadata.\n    license: "MIT"\n\n    # The SSH private key that should be used to commit to the Git repository.\n    # This can either be a path or the key contents.\n    #\n    # IMPORTANT: the key must not be password-protected.\n    #\n    # WARNING: do not expose your private key in the configuration file!\n    private_key: "{{ .Env.AUR_KEY }}"\n\n    # The AUR Git URL for this package.\n    # Publish is skipped if empty.\n    git_url: "ssh://aur@aur.archlinux.org/mypackage.git"\n\n    # Setting this will prevent kmdo to actually try to commit the updated\n    # formula - instead, the formula file will be stored on the dist directory\n    # only, leaving the responsibility of publishing it to the user.\n    #\n    # If set to auto, the release will not be uploaded to the AUR repo\n    # in case there is an indicator for prerelease in the tag e.g. v1.0.0-rc1.\n    skip_upload: true\n\n    # List of additional packages that the software provides the features of.\n    #\n    # Default: the project name.\n    provides:\n      - myapp\n\n    # List of packages that conflict with, or cause problems with the package.\n    #\n    # Default: the project name.\n    conflicts:\n      - myapp\n\n    # List of packages that must be installed to install this.\n    depends:\n      - curl\n\n    # List of packages that are not needed for the software to function,\n    # but provide additional features.\n    #\n    # Must be in the format `package: short description of the extra functionality`.\n    optdepends:\n      - "wget: for downloading things"\n\n    # List of packages that must be installed to build this.\n    # Default: ["go", "git"]\n    makedepends:\n      - make\n\n    # List of files that can contain user-made changes and should be preserved\n    # during package upgrades and removals.\n    backup:\n      - /etc/foo.conf\n\n    # Custom prepare instructions.\n    prepare: |-\n      cd "${pkgname}_${pkgver}"\n      go mod download\n\n    # Custom build instructions.\n    build: |-\n      cd "${pkgname}_${pkgver}"\n      export CGO_CPPFLAGS="${CPPFLAGS}"\n      export CGO_CFLAGS="${CFLAGS}"\n      export CGO_CXXFLAGS="${CXXFLAGS}"\n      export CGO_LDFLAGS="${LDFLAGS}"\n      export GOFLAGS="-buildmode=pie -trimpath -mod=readonly -modcacherw"\n      go build -ldflags="-w -s -buildid=\'\' -linkmode=external -X main.version=${pkgver}" .\n      chmod +x ./kmdo\n\n    # Custom package instructions.\n    package: |-\n      cd "${pkgname}_${pkgver}"\n      install -Dsm755 ./myapp "${pkgdir}/usr/bin/myapp"\n\n    # This will be added into the package as \'name.install\'.\n    # In this file, you may define functions like `pre_install`, `post_install`,\n    # and so on.\n    #\n    install: ./scripts/install.sh\n\n    # Commit message.\n    #\n    # Default: \'Update to {{ .Tag }}\'.\n    # Templates: allowed.\n    commit_msg_template: "pkgbuild updates"\n\n    # If you build for multiple GOAMD64 versions, you may use this to choose which one to use.\n    #\n    # Default: \'v1\'.\n    goamd64: v2\n\n    # The value to be passed to `GIT_SSH_COMMAND`.\n    # This is mainly used to specify the SSH private key used to pull/push to\n    # the Git URL.\n    #\n    # Default: \'ssh -i {{ .KeyPath }} -o StrictHostKeyChecking=accept-new -F /dev/null\'.\n    git_ssh_command: "ssh -i {{ .Env.KEY }} -o SomeOption=yes"\n\n    # URL which is determined by the given Token\n    # (github, gitlab or gitea).\n    #\n    # Default: depends on the client.\n    # Templates: allowed.\n    url_template: "http://github.mycompany.com/foo/bar/releases/{{ .Tag }}/{{ .ArtifactName }}"\n\n    # Directory in which the files will be created inside the repository.\n    # Only useful if you\'re creating your own AUR with multiple packages in a\n    # single repository.\n    #\n    # Default: \'.\'.\n    # Templates: allowed.\n    directory: "."\n\n    # Whether to disable this particular AUR configuration.\n    #\n    # Templates: allowed.\n    disable: "{{ .IsSnapshot }}"\n\n    # Git author used to commit to the repository.\n    #\n    # Default: inferred from global metadata (Since v2.12).\n    commit_author:\n      # Git author name.\n      #\n      # Templates: allowed.\n      name: kumosebot\n\n      # Git author email.\n      #\n      # Templates: allowed.\n      email: bot@kumose.cc\n\n      # Git commit signing configuration.\n      # Only useful if repository is of type \'git\'.\n      #\n      signing:\n        # Enable commit signing.\n        enabled: true\n\n        # The signing key to use.\n        # Can be a key ID, fingerprint, email address, or path to a key file.\n        #\n        # Templates: allowed.\n        key: "{{ .Env.GPG_SIGNING_KEY }}"\n\n        # The GPG program to use for signing.\n        #\n        # Templates: allowed.\n        program: gpg2\n\n        # The signature format to use.\n        #\n        # Valid options: openpgp, x509, ssh.\n        # Default: openpgp.\n        format: openpgp\n\n'})}),"\n",(0,a.jsx)(n.admonition,{type:"warning",children:(0,a.jsxs)(n.p,{children:["For more info about what each field does, please refer to\n",(0,a.jsx)(n.a,{href:"https://wiki.archlinux.org/title/PKGBUILD",children:"Arch's PKGBUILD reference"}),"."]})})]})}function c(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(u,{...e})}):u(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>r});var o=t(6540);const a={},i=o.createContext(a);function s(e){const n=o.useContext(i);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),o.createElement(i.Provider,{value:n},e.children)}}}]);