"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[4407],{2169:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>a,contentTitle:()=>r,default:()=>u,frontMatter:()=>s,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"tutorial/pub/publish/blob","title":"Blobs (s3, gcs, azblob)","description":"The blobs allows you to upload artifacts to Amazon S3, Azure Blob and","source":"@site/docs/tutorial/pub/publish/blob.mdx","sourceDirName":"tutorial/pub/publish","slug":"/tutorial/pub/publish/blob","permalink":"/kmdo/docs/tutorial/pub/publish/blob","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Arch User Repositories (Sources)","permalink":"/kmdo/docs/tutorial/pub/publish/aursources"},"next":{"title":"Changelog","permalink":"/kmdo/docs/tutorial/pub/publish/changelog"}}');var i=o(4848),l=o(8453);const s={},r="Blobs (s3, gcs, azblob)",a={},c=[{value:"Customization",id:"customization",level:2},{value:"Authentication",id:"authentication",level:2},{value:"S3 Provider",id:"s3-provider",level:3},{value:"Azure Blob Provider",id:"azure-blob-provider",level:3},{value:"GCS Provider",id:"gcs-provider",level:3},{value:"ACLs",id:"acls",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"blobs-s3-gcs-azblob",children:"Blobs (s3, gcs, azblob)"})}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"blobs"})," allows you to upload artifacts to Amazon S3, Azure Blob and\nGoogle GCS."]}),"\n",(0,i.jsx)(n.h2,{id:"customization",children:"Customization"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",metastring:'title=".kmdopkg.yaml"',children:"blobs:\n  # You can have multiple blob configs\n  - # Cloud provider name:\n    # - s3 for AWS S3 Storage\n    # - azblob for Azure Blob Storage\n    # - gs for Google Cloud Storage\n    #\n    # Templates: allowed.\n    provider: azblob\n\n    # Set a custom endpoint, useful if you're using a minio backend or\n    # other s3-compatible backends.\n    #\n    # Implies s3ForcePathStyle and requires provider to be `s3`\n    #\n    # Templates: allowed.\n    endpoint: https://minio.foo.bar\n\n    # Sets the bucket region.\n    # Requires provider to be `s3`\n    #\n    # Templates: allowed.\n    region: us-west-1\n\n    # Disables SSL\n    # Requires provider to be `s3`\n    disable_ssl: true\n\n    # Bucket name.\n    #\n    # Templates: allowed.\n    bucket: kumose-bucket\n\n    # IDs of the artifacts you want to upload.\n    ids:\n      - foo\n      - bar\n\n\n    # Path/name inside the bucket.\n    #\n    # Default: '{{ .ProjectName }}/{{ .Tag }}'.\n    # Templates: allowed.\n    directory: \"foo/bar/{{.Version}}\"\n\n    # Whether to disable this particular upload configuration.\n    #\n    # Templates: allowed.\n    disable: '{{ ne .BLOB_UPLOAD_ONLY \"foo\" }}'\n\n    # You can add extra pre-existing files to the bucket.\n    #\n    # The filename on the release will be the last part of the path (base).\n    # If another file with the same name exists, the last one found will be used.\n    # These globs can also include templates.\n    extra_files:\n      - glob: ./path/to/file.txt\n      - glob: ./glob/**/to/**/file/**/*\n      - glob: ./glob/foo/to/bar/file/foobar/override_from_previous\n      - glob: ./single_file.txt\n        # Templates: allowed.\n        name_template: file.txt # note that this only works if glob matches 1 file only\n\n\n    # Allow to disable `s3ForcePathStyle`.\n    #\n    # Default: true.\n    s3_force_path_style: false\n\n    # ACL to be applied to all files in this configuration.\n    #\n    # If you need different ACLs for different files, create multiple `blobs`\n    # configurations.\n    #\n    # Only available when `provider` is S3.\n    #\n    # Default: ''.\n    acl: foo\n\n    # Cache control options.\n    #\n    # If you need different `cache_control` options for different files,\n    # create multiple `blobs` configurations.\n    #\n    # Default: ''.\n    cache_control:\n      - max-age=9999\n      - public\n\n    # Allows to set the content disposition of the file.\n    #\n    # If you need different `content_disposition` options for different files,\n    # create multiple `blobs` configurations.\n    #\n    # Default: attachment;filename={{.Filename}}.\n    # Templates: allowed.\n    # Disable by setting the value to '-'\n    content_disposition: \"inline\"\n\n    # Upload metadata.json and artifacts.json to the release as well.\n    include_meta: true\n\n    # Upload only the files defined in extra_files.\n    extra_files_only: true\n"})}),"\n",(0,i.jsx)(n.h2,{id:"authentication",children:"Authentication"}),"\n",(0,i.jsx)(n.p,{children:"Kmdo's blob pipe authentication varies depending upon the blob provider as mentioned below:"}),"\n",(0,i.jsx)(n.h3,{id:"s3-provider",children:"S3 Provider"}),"\n",(0,i.jsxs)(n.p,{children:["S3 provider support AWS\n",(0,i.jsx)(n.a,{href:"https://docs.aws.amazon.com/sdk-for-go/v1/developer-guide/configuring-sdk.html#specifying-credentials",children:"default credential provider"}),"\nchain in the following order:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Environment variables."}),"\n",(0,i.jsx)(n.li,{children:"Shared credentials file."}),"\n",(0,i.jsx)(n.li,{children:"If your application is running on an Amazon EC2 instance, IAM role for Amazon EC2."}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"azure-blob-provider",children:"Azure Blob Provider"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"blobs:\n  - provider: azblob\n    bucket: releases?storage_account=myazurestorage\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Storage account is set over URL param ",(0,i.jsx)(n.code,{children:"storage_account"})," in ",(0,i.jsx)(n.code,{children:"bucket"})," or in environment variable ",(0,i.jsx)(n.code,{children:"AZURE_STORAGE_ACCOUNT"})]}),"\n",(0,i.jsx)(n.p,{children:"It supports authentication with"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/azure/storage/common/storage-azure-cli#set-default-azure-storage-account-environment-variables",children:"environment variables"}),":","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"AZURE_STORAGE_KEY"})," or ",(0,i.jsx)(n.code,{children:"AZURE_STORAGE_SAS_TOKEN"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/azure/developer/go/azure-sdk-authentication-service-principal",children:"default Azure credential"})}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"gcs-provider",children:(0,i.jsx)(n.a,{href:"https://cloud.google.com/docs/authentication/production",children:"GCS Provider"})}),"\n",(0,i.jsxs)(n.p,{children:["GCS provider uses\n",(0,i.jsx)(n.a,{href:"https://cloud.google.com/docs/authentication/production",children:"Application Default Credentials"}),"\nin the following order:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Environment Variable (",(0,i.jsx)(n.code,{children:"GOOGLE_APPLICATION_CREDENTIALS"}),")"]}),"\n",(0,i.jsx)(n.li,{children:"Default Service Account from the compute instance (Compute Engine,\nKubernetes Engine, Cloud function etc)."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"acls",children:"ACLs"}),"\n",(0,i.jsxs)(n.p,{children:["There is no common way to set ACLs across all bucket providers, so, ",(0,i.jsx)(n.a,{href:"https://gocloud.dev/howto/blob/",children:"go-cloud"}),"\n",(0,i.jsx)(n.a,{href:"https://github.com/google/go-cloud/issues/1108",children:"does not support it yet"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"You are expected to set the ACLs on the bucket/directory/etc, depending on your\nprovider."})]})}function u(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,n,o)=>{o.d(n,{R:()=>s,x:()=>r});var t=o(6540);const i={},l=t.createContext(i);function s(e){const n=t.useContext(l);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),t.createElement(l.Provider,{value:n},e.children)}}}]);