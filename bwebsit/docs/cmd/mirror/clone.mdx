---
slug: /cmd/mirror/clone
---
# kmdo mirror clone 命令文档
## 概述
kmdo mirror clone 命令用于将远程镜像仓库完整复制到本地目录，包含所有二进制组件、关联部署文件及版本元数据，与 `pull` 命令的增量更新不同，该命令获取镜像全量数据集，生成可独立使用的本地镜像，支持离线使用或作为后续操作的基准。该功能计划在 kmdo 0.8+ 版本正式支持。

## 命令结构
kmdo mirror clone [REMOTE_MIRROR_URL] [LOCAL_DIR] [--options]

## 核心功能
1. 全量复制远程镜像仓库的所有内容，包括二进制组件、部署文件、版本元数据。
2. 在本地指定目录创建独立的镜像仓库，不依赖远程镜像即可使用。
3. 保留远程镜像的完整目录结构和版本记录，确保本地镜像与远程源完全一致。
4. 支持离线使用：克隆完成后，本地镜像可脱离网络独立提供组件查询、部署等功能。

## 与 mirror pull 的核心区别
| 特性 | kmdo mirror clone | kmdo mirror pull |
|------|-------------------|------------------|
| 数据获取方式 | 全量复制整个镜像仓库 | 增量拉取新增/修改的制品 |
| 本地独立性 | 生成完全独立的本地镜像，可离线使用 | 依赖现有本地镜像，补充增量数据 |
| 适用场景 | 首次获取镜像、创建基准镜像、离线使用 | 同步远程更新、补充特定版本制品 |
| 数据体积 | 传输全量数据，体积较大 | 传输增量数据，体积较小 |

## 适用场景
1. 首次使用镜像时，全量克隆远程镜像到本地，搭建独立镜像环境。
2. 为离线环境（如无网络的内网服务器）克隆镜像，保障离线部署需求。
3. 创建镜像的基准副本，用于测试、备份或二次定制开发。
4. 跨环境迁移镜像（如从公网镜像克隆到内网镜像仓库）。

## 命令说明
### 用法
必须指定远程镜像URL和本地目录，可选选项根据需求补充：
```shell
kmdo mirror clone <REMOTE_MIRROR_URL> <LOCAL_DIR> [--options]

### 示例（基于功能推测）
# 克隆远程镜像到本地指定目录
kmdo mirror clone https://github.com/kumose/official-mirror.git ./local-mirror

# 克隆时指定分支（假设支持 --branch 选项）
kmdo mirror clone https://github.com/kumose/official-mirror.git ./local-mirror --branch main

# 强制克隆（覆盖已存在的本地目录，需谨慎使用）
kmdo mirror clone https://github.com/kumose/official-mirror.git ./local-mirror --force
```
## 前置条件
1. 功能可用性：需升级 kmdo 至 0.8+ 版本（低版本暂不支持）。
2. 网络连通：本地环境可访问目标远程镜像仓库（HTTP/SSH 协议均可）。
3. 权限要求：拥有远程镜像仓库的读取权限，若需认证需提前配置（如 SSH 密钥、Git 用户名密码）。
4. 本地空间：本地目录所在磁盘有足够存储空间，用于存储全量镜像数据（建议提前确认远程镜像体积）。

## 注意事项
1. 全量复制特性：克隆过程会传输远程镜像的所有数据，耗时和网络带宽消耗可能较大，建议在网络稳定环境下执行。
2. 本地目录处理：若指定的本地目录已存在，默认可能报错（避免覆盖数据），需通过 --force 选项强制覆盖（执行前请备份目录内重要数据）。
3. 独立使用：克隆完成后，本地目录即为完整的镜像仓库，可通过 `kmdo mirror set <LOCAL_DIR>` 配置为当前工作区，直接使用。
4. 选项补充：--options 具体参数（如分支指定、克隆深度、认证配置等）将在 0.8+ 版本发布时补充，可参考在线文档获取最新信息。
5. 在线文档：详细使用说明可访问 https://docs.kumose.cc/kmdo/docs/cmd/mirror/clone 查看。

## 待补充说明（0.8+ 版本发布后更新）
- 支持的 --options 列表及功能描述（如 --branch、--force、--depth、--quiet 等）。
- 远程镜像 URL 的支持格式（如 Git 仓库地址、HTTP 镜像服务地址等）。
- 克隆进度展示与中断后恢复机制。
- 克隆失败的常见原因及排查方案（如网络中断、权限不足、磁盘空间不足等）。
- 克隆后本地镜像的初始化配置步骤（如关联远程、设置默认组件等）。